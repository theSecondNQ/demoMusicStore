<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>我的收藏 - 音乐商店</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 1000px; margin: 0 auto; padding: 20px; }
        .header { margin-bottom: 20px; }
        .favourite-list { list-style: none; padding: 0; }
        .favourite-item { border: 1px solid #ddd; padding: 15px; margin-bottom: 10px; border-radius: 5px; }
        .music-title { font-size: 18px; font-weight: bold; }
        .music-info { color: #666; margin: 5px 0; }
        .actions { margin-top: 10px; }
        .btn { padding: 5px 10px; border: none; border-radius: 3px; cursor: pointer; text-decoration: none; display: inline-block; }
        .btn-primary { background: #007bff; color: white; }
        .btn-danger { background: #dc3545; color: white; }
        .empty-message { text-align: center; padding: 40px; color: #666; }
        .favourite-count { margin-bottom: 15px; padding: 10px; background: #f8f9fa; border-radius: 5px; }
    </style>
</head>
<body>
<div class="header">
    <a th:href="@{/music/list}">← 返回音乐列表</a>
    <h1 style="text-align: center;">我的收藏</h1>
</div>

<div class="favourite-count" th:if="${favouriteCount > 0}">
    共收藏 <strong th:text="${favouriteCount}"></strong> 首音乐
</div>

<div th:if="${favourites != null and !favourites.isEmpty()}">
    <ul class="favourite-list">
        <li th:each="favourite : ${favourites}" class="favourite-item">
            <div class="music-title" th:text="${favourite.musicTitle}"></div>
            <div class="music-info">
                歌手：<span th:text="${favourite.artist}"></span> |
                专辑：<span th:text="${favourite.album}"></span> |
                分类：<span th:text="${favourite.categoryName}"></span> |
                价格：￥<span th:text="${#numbers.formatDecimal(favourite.price, 1, 2)}"></span>
            </div>
            <div class="music-info">
                收藏时间：<span th:text="${#dates.format(favourite.createTime, 'yyyy-MM-dd HH:mm')}"></span>
            </div>
            <div class="actions">
                <a th:href="@{'/music/detail/' + ${favourite.musicId}}" class="btn btn-primary">查看详情</a>
                <form th:action="@{'/favourite/remove/' + ${favourite.musicId}}" method="post" style="display: inline;">
                    <button type="submit" class="btn btn-danger">取消收藏</button>
                </form>
                <form th:action="@{/cart/add}" method="post" style="display: inline;">
                    <input type="hidden" name="musicId" th:value="${favourite.musicId}">
                    <input type="number" name="quantity" value="1" min="1" style="width: 60px;">
                    <button type="submit" class="btn btn-primary">加入购物车</button>
                </form>
            </div>
        </li>
    </ul>
</div>

<div th:if="${favourites == null or favourites.isEmpty()}" class="empty-message">
    <h3>暂无收藏的音乐</h3>
    <p>去 <a th:href="@{/music/list}">音乐列表</a> 发现喜欢的音乐吧！</p>
</div>

<div th:replace="fragments/footer :: footer"></div>
</body>
</html>